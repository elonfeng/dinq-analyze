# DINQ 环境变量配置示例（不包含任何真实密钥）
#
# 用法：
# - 本地开发：建议复制为 `.env`，并把真实密钥放在 `.env.local`（已在 .gitignore 中）
# - CI/生产：建议用系统环境变量注入（环境变量优先级高于 .env 文件）
#
# 加载顺序（不覆盖已存在的环境变量）：
# `.env.<env>.local` → `.env.local` → `.env.<env>` → `.env`

# ==============================================================================
# 1) 运行环境 & 服务监听
# ==============================================================================

# 环境设置 (development, test, production)
DINQ_ENV=development

# 服务监听（可选；也可通过启动参数 --host/--port 覆盖）
# DINQ_HOST=127.0.0.1
# DINQ_PORT=5001

# API 域名前缀（用于生成报告 URL / 下载链接等）
# - 开发环境示例: http://127.0.0.1:5001
# - 测试环境示例: https://test-api.dinq.ai
# - 生产环境示例: https://api.dinq.ai
DINQ_API_DOMAIN=http://localhost:5001

# ==============================================================================
# 2) 数据库（本地/CI/生产）
# ==============================================================================

# 推荐：使用单个 URL 配置数据库（便于本地/CI/生产切换）
# 例：本地 compose(Postgres): postgresql+psycopg2://dinq:dinq@127.0.0.1:5432/dinq
# DINQ_DB_URL=postgresql+psycopg2://dinq:dinq@127.0.0.1:5432/dinq
#
# 兼容别名（不推荐；仅为历史兼容）
# DATABASE_URL=
# DB_URL=

# DB 连接参数（可选；仅对非 SQLite 有效）
# DINQ_DB_ECHO=false
# DINQ_DB_POOL_SIZE=10
# DINQ_DB_MAX_OVERFLOW=20
# DINQ_DB_POOL_TIMEOUT=30
# DINQ_DB_POOL_RECYCLE=3600
# DINQ_DB_CONNECT_TIMEOUT=30
# DINQ_DB_APP_NAME=DINQ_App

# Compose 端口（可选，不配置则使用 compose.yaml 默认值）
# DINQ_PG_PORT=5432
# DINQ_MAILHOG_SMTP_PORT=1025
# DINQ_MAILHOG_WEB_PORT=8025

# 是否在 import DB cache 模块时自动 create_tables
# - 本地/CI：建议在测试脚本里显式调用 create_tables（更可控）
# - 生产：通常交给迁移系统，而不是应用启动时自动建表
# DINQ_DB_AUTO_CREATE_TABLES=false

# ==============================================================================
# 3) 日志/可观测性（可选）
# ==============================================================================

# 日志配置
LOG_LEVEL=INFO
LOG_DIR=logs

# Sentry 监控配置
# Sentry DSN（从 Sentry 项目设置中获取；不配则完全禁用 Sentry）
# SENTRY_DSN=https://your-sentry-dsn-here@o123456.ingest.sentry.io/project-id
# 环境名称 (development, staging, production)
SENTRY_ENVIRONMENT=development
# 性能监控采样率 (0.0 到 1.0，1.0 表示 100% 采样)
SENTRY_TRACES_SAMPLE_RATE=0.1
# 性能分析采样率 (0.0 到 1.0)
SENTRY_PROFILES_SAMPLE_RATE=0.1
# 是否发送个人识别信息 (true/false)
SENTRY_SEND_DEFAULT_PII=false

# Axiom 日志配置
# Axiom API 令牌（不配则可关闭 AXIOM_ENABLED）
# AXIOM_TOKEN=your_axiom_token_here
# Axiom 数据集名称
AXIOM_DATASET=dinq_logs
# 是否启用 Axiom 日志 (true/false)
AXIOM_ENABLED=false

# ==============================================================================
# 4) 认证/邮件（本地离线/线上）
# ==============================================================================

# 绕过 require_verified_user（仅用于离线测试；不要在生产打开）
# DINQ_AUTH_BYPASS=true

# Email 后端选择：
# - resend: 使用 Resend（在线）
# - smtp: 走 SMTP（可配 MailHog 离线收件箱）
# - file/noop: 只写 outbox 或直接忽略
# DINQ_EMAIL_BACKEND=file
# DINQ_TEST_EMAIL_OUTBOX_PATH=./.test_outbox/emails.jsonl
# DINQ_SMTP_HOST=localhost
# DINQ_SMTP_PORT=1025

# Firebase 配置（可选；未配置时按代码默认路径/策略运行）
# FIREBASE_SERVICE_ACCOUNT_PATH=./server/secrets/firebase-adminsdk.json
# FIREBASE_SKIP_AUTH_IN_DEV=true

# ==============================================================================
# 5) 外部 API/LLM 密钥（按需开启能力）
# ==============================================================================

# Kimi API (Moonshot)
# KIMI_API_KEY=your_kimi_api_key_here

# OpenRouter API
# OPENROUTER_API_KEY=your_openrouter_api_key_here
# 可选：覆盖默认模型（例如 openai/gpt-4o-mini / anthropic/claude-3.5-sonnet）
# OPENROUTER_MODEL=
# 可选：按“需求/任务”切换模型（速度优先）
# DINQ_LLM_MODEL_FAST=google/gemini-2.5-flash-lite
# DINQ_LLM_MODEL_BALANCED=google/gemini-2.5-flash
# DINQ_LLM_MODEL_FLASH_PREVIEW=google/gemini-3-flash-preview
# DINQ_LLM_MODEL_CODE_FAST=x-ai/grok-code-fast-1
# DINQ_LLM_MODEL_REASONING_FAST=x-ai/grok-4.1-fast
# 可选：按 task 覆盖（task 会被转为大写下划线）
# 例如 task="github_ai" -> DINQ_LLM_TASK_MODEL_GITHUB_AI
# DINQ_LLM_TASK_MODEL_GITHUB_AI=x-ai/grok-code-fast-1
# 兼容别名（历史兼容）
# OPENROUTER_KEY=

# GitHub Token（用于 GitHub Analyzer / online smoke）
# GITHUB_TOKEN=ghp_xxx
# GitHub profile-first UX：profile 卡优先快速产出（超时自动降级）
# DINQ_GITHUB_PROFILE_TIMEOUT_SECONDS=8
# DINQ_GITHUB_PROFILE_REST_TIMEOUT_SECONDS=6

# SiliconFlow API
# SILICONFLOW_API_KEY=your_siliconflow_api_key_here

# Tavily API (for find_arxiv)
# TAVILY_API_KEY=your_tavily_api_key_here

# Crawlbase API
# CRAWLBASE_API_TOKEN=your_crawlbase_api_token_here
# 兼容别名（历史兼容）
# CRAWLBASE_TOKEN=

# Firecrawl（用于部分抓取补全；缺失时应自动降级/跳过）
# FIRECRAWL_API_KEY=your_firecrawl_api_key_here

# LinkedIn 抓取（按需）
# SCRAPINGDOG_API_KEY=your_scrapingdog_api_key_here

# Apify（按需）
# APIFY_API_KEY=your_apify_api_key_here

# Twitter（按需）
# TWITTER_API_KEY=
# TWITTER_API_SECRET=
# TWITTER_ACCESS_TOKEN=
# TWITTER_ACCESS_TOKEN_SECRET=
# TWITTER_BEARER_TOKEN=

# Generic OpenRouter API (from ai_tools.py; 可与 OPENROUTER_API_KEY 同值)
# GENERIC_OPENROUTER_API_KEY=your_openrouter_api_key_here

# YouTube Data API v3
# 获取方式: https://console.developers.google.com/
# 需要启用 YouTube Data API v3 服务
# YOUTUBE_API_KEY=your_youtube_api_key_here

# Resend（发邮件用；DINQ_EMAIL_BACKEND=resend 时需要）
# RESEND_API_KEY=

# ==============================================================================
# 6) Scholar 抓取调度/缓存（可选；默认值可运行）
# ==============================================================================

# Scholar 抓取调度/缓存（可选，建议本地/生产都开启磁盘缓存）
# 说明：
# - 这些配置只影响 Scholar 抓取层（requests/crawlbase/firecrawl 的统一封装）
# - 不配置也能运行：代码内有合理默认值
# - 推荐优先靠「缓存/去重/增量」提效，而不是提高并发或代理池

# 直连抓取：同一域名最大 in-flight 并发（默认 1；Scholar 建议保持 1）
# DINQ_SCHOLAR_FETCH_MAX_INFLIGHT_PER_DOMAIN=1

# 抓取磁盘缓存目录（开启后可显著减少重复请求；留空则关闭）
# DINQ_SCHOLAR_FETCH_DISK_CACHE_DIR=./cache/scholar_fetch
# DINQ_SCHOLAR_FETCH_DISK_CACHE_TTL_SECONDS=86400

# 抓取配额（按 user_id + domain + day 计数；0 表示关闭）
# DINQ_SCHOLAR_FETCH_QUOTA_MAX_PER_DAY=0
# DINQ_SCHOLAR_FETCH_QUOTA_STATE_PATH=./cache/scholar_fetch/quota.json

# Scholar 报告抓取论文上限（影响分页次数；简化模式主要用于 PK 提速）
# DINQ_SCHOLAR_MAX_PAPERS_FULL=500
# DINQ_SCHOLAR_MAX_PAPERS_SIMPLIFIED=200

# Simplified/PK：max_papers 自适应（默认会把“普通学者”降到 100 篇 -> 少抓 1 页，显著减少请求）
# DINQ_SCHOLAR_MAX_PAPERS_SIMPLIFIED_MIN=100
# DINQ_SCHOLAR_SIMPLIFIED_ADAPT_CITATIONS_THRESHOLD=1500
# DINQ_SCHOLAR_SIMPLIFIED_ADAPT_HINDEX_THRESHOLD=25

# ==============================================================================
# 7) 测试/基准（本地/CI 手动触发）
# ==============================================================================

# Online smoke（真实外部依赖；不稳定，建议手动触发）
# DINQ_RUN_ONLINE_SMOKE=true
# DINQ_SMOKE_BASE_URL=http://127.0.0.1:5001
# DINQ_SMOKE_SCHOLAR=true
# DINQ_SMOKE_SCHOLAR_PK=true
